# This is a sample Makefile.in 

# @CXXFLAGS@     : is set to -g -Wall (when debuging) or -O2 -Wall (when not)
# @all_includes@ : is set to all needed include paths for QT, KDE and X11
# -I.. 	         : needed for config.h
CXXFLAGS= @CXXFLAGS@ @all_includes@ -DHAVE_CONFIG_H -I..

# @LDFLAGS@    : is set to -s (when not debuging) for stripping
# @all_libra.@ : is set to all needed libraries paths for QT, KDE and X11
# you need also @LIBSOCKET@, if you link with -lkfm
LDFLAGS	= @LDFLAGS@ @all_libraries@ -lkdecore -lkdeui -lqt -lXext -lX11 -lmediatool @LIBCOMPAT@ @LIBSOCKET@

# both are clear, I think
CXX     = @CXX@
MOC   	= @MOC@
GMSGFMT = @GMSGFMT@
MSGFMT  = @MSGFMT@
XGETTEXT = @XGETTEXT@


############# INSTALL #################

install = @INSTALL@
INSTALL = $(install) -m 0755
INSTALL_DATA = $(install) -m 0644
INSTALL_DIR = $(install) -d -m 0755
INSTALL_DIR_PRIVATE = $(install) -d -m 0700

prefix = @prefix@
KDEINC = $(prefix)/include
BINDIR = $(prefix)/bin
LIBDIR = $(prefix)/lib
APPDIR = $(prefix)/share/apps/kmedia

########### File Formats ###########

.SUFFIXES: .cpp .po

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $<

#%.moc: %.h
#	$(MOC) $< -o $@
#
#%.mo: %.po
#	$(MSGFMT) -o $@ $<
#
#.po.gmo:
#	file=$(srcdir)/echo $* | sed 's,.*/,,'.gmo \
#	&& rm -f $$file && $(GMSGFMT) -o $$file $<


########## Files #####################

OBJECTS =	kmedia.o uiactions.o mediaactions.o prefs.o kmediawin.o
SRCS :=         $(OBJECTS:*.o:*.c)
SRCMETA =	kmedia.moc prefs.moc kmediawin.moc
SRCNLS  :=	$(patsubst %.po,%, $(wildcard *.po))
OBJNLS  :=	$(patsubst %,%.mo, $(SRCNLS))
TARGET	=	kmedia

######### build rules ################

all: $(TARGET) # .depend


$(TARGET): $(SRCMETA) $(OBJECTS) $(OBJNLS)
	$(CXX) $(OBJECTS) -o $(TARGET) $(LDFLAGS)

clean:
	rm -f *.o *.bak .depend *~ *% #*
	rm -f $(SRCMETA) $(TARGET)
	rm -f *.mo

distclean: clean
	rm -f Makefile

#.depend: $(SRCS)
#	@if test ! -f .depend ; then $(MAKE) depend ; fi

#depend:
#	@echo "Creating dependencies."
#	@makedepend $(INCDIRS) $(SRCS)
#	touch .depend

install: $(TARGET) install-appdir install-icons # install-nls
	$(INSTALL_DIR) $(BINDIR)
	$(INSTALL) $(TARGET) $(BINDIR)
	$(INSTALL_DIR) $(prefix)/share/doc/HTML/en/kmedia
	$(INSTALL_DATA) kmedia.html $(prefix)/share/doc/HTML/en/kmedia
	$(INSTALL_DIR) $(prefix)/share/applnk/Multimedia
	$(INSTALL_DATA) KMedia.kdelnk $(prefix)/share/applnk/Multimedia

install-appdir:
	$(INSTALL_DIR) $(APPDIR)

install-icons:
	$(INSTALL_DIR) $(APPDIR)/pics
	$(INSTALL_DATA) pics/media.xpm pics/playpause.xbm pics/playpause_both.xpm pics/playpause_play.xpm $(APPDIR)/pics

#install-nls:
#	for i in $(SRCNLS); do $(INSTALL_DIR) $(prefix)/share/locale/$$i/LC_MESSAGES; $(INSTALL_DATA) $$i.mo $(prefix)/share/locale/$$i/LC_MESSAGES/kmedia.mo; done

uninstall:
	rm -f $(BINDIR)/$(TARGET)

kmedia.moc: kmedia.h
	$(MOC) kmedia.h -o kmedia.moc

kmediawin.moc: kmediawin.h
	$(MOC) kmediawin.h -o kmediawin.moc

prefs.moc: prefs.h
	$(MOC) prefs.h -o prefs.moc

# DO NOT DELETE THIS LINE -- make depend depends on it.
